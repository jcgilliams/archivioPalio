<ion-content *ngIf="fantino; else loadingTpl">
  <div class="container">
    <section class="segment col-1 span-6 row-1 cavallo-header">
      <img [src]="fantino.foto" class="cavallo-foto" />
      <h2 class="cavallo-naam-groot">
        {{ fantino.nome }}<ng-container *ngIf="fantino.soprannome"> detto {{ fantino.soprannome }}</ng-container>
      </h2>
    </section>

    <section class="segment col-1 span-3 row-2">
      <div class="subsegment">
        <h2 class="section-header" (click)="showInfo = !showInfo" style="cursor: pointer;">
          {{ getTranslation('scheda') }}
          <ion-icon [name]="showInfo ? 'chevron-up-outline' : 'chevron-down-outline'" class="chevron-icon"></ion-icon>
        </h2>
        <div *ngIf="showInfo">
          <ion-grid>
            <ion-row class="equal-height-row">
              <ion-col *ngIf="fantino.nome">
                <ion-item style="align-items: flex-start;"  lines="none" class="ion-itemTransparant">       
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('nome') }}</p>
                    <span>{{fantino.nome}}</span>
                  </ion-text> 
                </ion-item>
              </ion-col>
              <ion-col *ngIf="fantino.soprannome">
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text color="kleur2" class="cavallo-label">
                    <p class="custom">{{ getTranslation('soprannome') }}</p>
                    <span>{{fantino.soprannome}}</span>
                  </ion-text>
                </ion-item>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col *ngIf="fantino.annoNascita">
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text color="kleur2" class="cavallo-label">
                    <p class="custom">{{ getTranslation('anno') }}</p>
                    <span>{{fantino.annoNascita}}</span>
                  </ion-text>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
    </section>

    <section class="segment col-4 span-3 row-2">
      <div class="subsegment">
        <h2 class="section-header" (click)="showExperience = !showExperience" style="cursor: pointer;">
          {{ getTranslation('esperienza') }}
          <ion-icon [name]="showExperience ? 'chevron-up-outline' : 'chevron-down-outline'" class="chevron-icon"></ion-icon>
        </h2>
        <div *ngIf="showExperience">
          <ion-grid>
            <ion-row class="equal-height-row">
              <ion-col>
                <ion-item lines="none" class="ion-itemTransparant">       
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('corsi') }}</p>
                    <div style="display: flex; gap: 4px;">
                      <span>{{fantino.paliiCorsi}}</span>
                    </div>
                  </ion-text> 
                </ion-item>
              </ion-col>
              <ion-col>
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('vinti') }}</p>
                    <span>{{fantino.paliiVinti}}</span>
                  </ion-text>
                </ion-item>
              </ion-col>
            </ion-row>
            <ion-row *ngIf="percentualeVinti > 0">
              <ion-col>
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('percentuale') }}</p>
                    <span>{{percentualeVinti}} %</span>
                  </ion-text>
                </ion-item>
              </ion-col>
              <ion-col></ion-col>
            </ion-row>
            <ion-row *ngIf="fantino.paliiCorsi > 0">
              <ion-col>
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('esordio') }}</p>
                    <span>{{fantino.esordio}}</span>
                  </ion-text>
                </ion-item>
              </ion-col>
              <ion-col>
                <ion-item lines="none" class="ion-itemTransparant">
                  <ion-text class="cavallo-label">
                    <p class="custom">{{ getTranslation('ultimo') }}</p>
                    <span>{{fantino.ultimo}}</span>
                  </ion-text>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
    </section>
    <ng-container *ngIf="fantino.palioCorso && fantino.palioCorso.length > 0">
      <section class="segment col-1 span-6 row-3">
        <div class="subsegment">
          <h2 class="section-header" (click)="showPalio = !showPalio" style="cursor: pointer;">
            {{ getTranslation('elenco') }} {{ fantino.esordio }}
            <ion-icon [name]="showPalio ? 'chevron-up-outline' : 'chevron-down-outline'" class="chevron-icon"></ion-icon>
          </h2>
          <div *ngIf="showPalio">
            <ion-grid class="palio-grid">
            <!-- Desktop: tonen bij breed scherm -->
            <ion-row class="equal-height-row row-header hide-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>Contrada</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>{{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>

            <!-- Mobiel: tonen bij smal scherm -->
            <ion-row class="equal-height-row row-header show-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio - Contrada - {{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>
            <ion-row *ngFor="let palio of fantino.palioCorso; let i = index" 
                class="equal-height-row palio-mobile-stack"
                [ngClass]="{ 
                  'row-vinto': palio.vinto === true
                  }">
              <ion-col (click)="goToPalioDetail(palio.palioDate)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.drappellonePalioFoto"
                      [src]="palio.drappellonePalioFoto"
                      class="img-palio" />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.palio.nome }}</span>
                  </ion-text>  
                </div>               
              </ion-col>
              <ion-col (click)="goToContradaDetail(palio.contrada.nome)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.contrada.nome"
                      [src]="palio.contrada.logo"
                      class="img-palio" />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.contrada.nome }}</span>
                  </ion-text>  
                </div>
              </ion-col>
              <ion-col (click)="goToCavalloDetail(palio.cavallo.id)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.cavallo.foto"
                      [src]="palio.cavallo.palioFoto || palio.cavallo.foto"
                      class="img-palio"  />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.cavallo.nome }}
                    <p class="custom2" *ngIf="palio.cavallo.nome">
                      {{ palio.puntoCaduta?.punto }}
                    </p>
                    </span>
                  </ion-text> 
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
      </section>   
    </ng-container> 
    <ng-container *ngIf="fantino.palioBatterie && fantino.palioBatterie.length > 0">
      <section class="segment col-1 span-6 row-4">
        <div class="subsegment">
          <h2 class="section-header" (click)="showBatterie = !showBatterie" style="cursor: pointer;">
            Batterie Tratta
            <ion-icon [name]="showBatterie ? 'chevron-up-outline' : 'chevron-down-outline'" class="chevron-icon"></ion-icon>
          </h2>
          <div *ngIf="showBatterie">
            <ion-grid class="palio-grid">
            <!-- Desktop: tonen bij breed scherm -->
            <ion-row class="equal-height-row row-header hide-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>Batteria</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>{{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>

            <!-- Mobiel: tonen bij smal scherm -->
            <ion-row class="equal-height-row row-header show-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio - Batteria - {{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>
            <ion-row *ngFor="let palio of fantino.palioBatterie; let i = index" 
                class="equal-height-row palio-mobile-stack"
                [ngClass]="{ 
                  'row-vinto': palio.vinto === true
                  }">
              <ion-col (click)="goToPalioDetail(palio.palioDate)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.drappellonePalioFoto"
                      [src]="palio.drappellonePalioFoto"
                      class="img-palio" />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.palioNome }}</span>
                  </ion-text>  
                </div>               
              </ion-col>
              <ion-col>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <ion-text class="cavallo-label">
                    <span>{{ palio.batteriaNome }}</span>
                  </ion-text>  
                </div>
              </ion-col>
              <ion-col (click)="goToCavalloDetail(palio.cavallo.id)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.cavallo.foto"
                      [src]="palio.cavallo.foto"
                      class="img-palio"  />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.cavallo.nome }}
                    <p class="custom2" *ngIf="palio.cavallo.nome">
                      {{ palio.puntoCaduta }}
                    </p>
                    </span>
                  </ion-text> 
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
      </section>   
    </ng-container> 
      <ng-container *ngIf="fantino.palioProveDiNotte && fantino.palioProveDiNotte.length > 0">
      <section class="segment col-1 span-6 row-5">
        <div class="subsegment">
          <h2 class="section-header" (click)="showProveDiNotte = !showProveDiNotte" style="cursor: pointer;">
            Prove di Notte
            <ion-icon [name]="showProveDiNotte ? 'chevron-up-outline' : 'chevron-down-outline'" class="chevron-icon"></ion-icon>
          </h2>
          <div *ngIf="showProveDiNotte">
            <ion-grid class="palio-grid">
            <!-- Desktop: tonen bij breed scherm -->
            <ion-row class="equal-height-row row-header hide-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>Prova di Notte</span></ion-text>
              </ion-col>
              <ion-col>
                <ion-text class="cavallo-label"><span>{{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>

            <!-- Mobiel: tonen bij smal scherm -->
            <ion-row class="equal-height-row row-header show-on-mobile">
              <ion-col>
                <ion-text class="cavallo-label"><span>Palio - Prova di Notte - {{ getTranslation('cavallo') }}</span></ion-text>
              </ion-col>
            </ion-row>
            <ion-row *ngFor="let palio of fantino.palioProveDiNotte; let i = index" 
                class="equal-height-row palio-mobile-stack">
              <ion-col (click)="goToPalioDetail(palio.palioDate)" [style.cursor]="'pointer'">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <img *ngIf="palio.drappellonePalioFoto"
                      [src]="palio.drappellonePalioFoto"
                      class="img-palio" />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.palioNome }}</span>
                  </ion-text>  
                </div>                  
              </ion-col>
              <ion-col>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <ion-text class="cavallo-label">
                    <span>{{ palio.proveGiorno }} - {{ palio.proveNome }}</span>
                  </ion-text>  
                </div>
              </ion-col>
              <ion-col *ngIf="palio.cavallo.id; else noFantinoCol">
                <div style="display: flex; align-items: center; gap: 8px;"
                  (click)="goToCavalloDetail(palio.cavallo.id)" [style.cursor]="'pointer'">
                  <img *ngIf="palio.cavallo.foto" [src]="palio.cavallo.foto" class="img-palio" />
                  <ion-text class="cavallo-label">
                    <span>{{ palio.cavallo.nome }}</span>
                    <p class="custom2" *ngIf="palio.cavallo.nome">
                      {{ palio.puntoCaduta }}
                    </p>
                  </ion-text>
                </div>
              </ion-col>
              <!-- Als er géén fantino is -->
              <ng-template #noFantinoCol>
                <ion-col>
                  <ion-text class="cavallo-label" style="padding-left: 16px;">
                    <span>{{ getTranslation('nonCorse') }}</span>
                  </ion-text>
                </ion-col>
              </ng-template>
            </ion-row>
          </ion-grid>
        </div>
      </div>
      </section>   
    </ng-container> 
  </div>
  <ion-fab slot="fixed" vertical="bottom" horizontal="end">
    <ion-fab-button (click)="scrollToTop()" color="secondary">
      <ion-icon name="chevron-up-circle" color="primary"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>

<ng-template #loadingTpl>
  <div class="spinner-wrapper">
    <ion-spinner name="circular" color="light" class="ion-padding"></ion-spinner>
  </div>
</ng-template>

